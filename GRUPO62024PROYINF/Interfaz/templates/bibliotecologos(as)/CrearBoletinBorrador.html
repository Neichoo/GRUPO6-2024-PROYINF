<!DOCTYPE html>
<html lang="es">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>VIGIFIA: Crear Bolet√≠n</title>
    <link rel="stylesheet" href="{% static 'CSS/Navbar.css' %}">
    <link rel="stylesheet" href="{% static 'CSS/CrearBoletinBorrador.css' %}">
    <link rel="stylesheet" href="{% static 'CSS/Footer.css' %}">

    <!-- TinyMCE Editor -->
    <script src="https://cdn.tiny.cloud/1/dn8swrrkyf5nwaeh6hhmt0tabrog4l03n4bn7uzwzwdk7k1t/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    <script>
    tinymce.init({
        selector: 'textarea#basic-example',
        height: 500,
        plugins: [
            'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
            'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
            'insertdatetime', 'media', 'table', 'help', 'wordcount'
        ],
        toolbar: 'undo redo | blocks | ' +
        'bold italic backcolor | alignleft aligncenter ' +
        'alignright alignjustify | bullist numlist outdent indent | ' +
        'removeformat | help',
        content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:16px }'
    });
    </script>

    <!-- html2pdf.js para PDF local -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
</head>
<body>
    {% include 'base/componentes/Navbar.html' %}

    <form method="POST" action="{% url 'CrearBoletinBorrador' %}" id="form-guardar">
        {% csrf_token %}
        <input type="text" name="nombre_boletin" placeholder="Nombre del bolet√≠n" class="campo-nombre">

        <textarea id="basic-example" name="basic-example">
        <!-- Aqui comienza la creacion del bolet√≠n --> 
<div style="
    width: 816px;
    height: 860px;
    background-image: url('/static/IMG/portada.jpg');
    background-size: cover;
    background-position: center;
    padding: 50px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    box-sizing: border-box;
    position: relative;
">
  <!-- Logo arriba izquierda -->
  <img src="{% static 'IMG/Icono.png' %}" alt="Logo1" style="height: 80px; position: absolute; top: 20px; left: 20px;">

  <!-- Contenedor del t√≠tulo con margen para separarlo del borde y del logo -->
  <div style="background-color: rgba(33,108,44,1); color: white; padding: 20px; width: fit-content; margin-top: 120px; margin-left: 0;">
    <h1 style="margin: 0; font-size: 1.4rem;">Titulo del boletin</h1>
    <p style="margin: 0; font-size: 1.2rem;">09 de Junio de 2024</p>
  </div>

</div>
<hr>
<h1 style="color: #216c2c;">Prefacio</h1>
<div style="height: 3px; width: 100px; background-color: #216c2c; margin-bottom: 20px;"></div>

<p style="color: #000000;">
Con el objetivo de fortalecer el desarrollo sustentable del sector agroalimentario, la Fundaci√≥n para la Innovaci√≥n Agraria presenta este bolet√≠n generado mediante vigilancia estrat√©gica. Este informe cubre temas como {{temas_principales}} y est√° optimizado para consulta en dispositivos m√≥viles.
</p>

<ul style="color: #000000;">
<li>Una <strong>fuente b√°sica</strong> de informaci√≥n tecnol√≥gica</li>
<li>Un bolet√≠n <strong>especializado</strong> sobre {{lineamiento}}</li>
<li>Un resumen üß† para tomadores de decisi√≥n</li>
<li>Un informe adaptable a <code>&lt;contexto&gt;</code> regional</li>
<li>Una herramienta de monitoreo clim√°tico y agr√≠cola</li>
</ul>
<hr>
<h2 style="color: #216c2c;">Indice</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>
<hr>
<h2 style="color: #216c2c;">1. Noticias</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">noticia_1_titulo</h3>
<p><em>noticia_1_fecha</em></p>
<p>noticia_1_resumen</p>
<p><a href="{{noticia_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">noticia_2_titulo</h3>
<p><em>noticia_2_fecha</em></p>
<p>noticia_2_resumen</p>
<p><a href="{{noticia_2_url}}" target="_blank">Ver m√°s</a></p>

<hr>

<h2 style="color: #216c2c;">2. Publicaciones Cient√≠ficas</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">Publicacion_1_titulo</h3>
<p><em>Publicacion_1_fecha</em></p>
<p>Publicacion_1_resumen</p>
<p><a href="{{Publicacion_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">Publicacion_2_titulo</h3>
<p><em>Publicacion_2_fecha</em></p>
<p>Publicacion_2_resumen</p>
<p><a href="{{Publicacion_2_url}}" target="_blank">Ver m√°s</a></p>

<hr>

<h2 style="color: #216c2c;">3. Patentes</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">Patente_1_titulo</h3>
<p><em>Patente_1_fecha</em></p>
<p>Patente_1_resumen</p>
<p><a href="{{Patente_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">Patente_2_titulo</h3>
<p><em>Patente_2_fecha</em></p>
<p>Patente_2_resumen</p>
<p><a href="{{Patente_2_url}}" target="_blank">Ver m√°s</a></p>
<hr>

<h2 style="color: #216c2c;">4. Proyectos</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">Proyecto_1_titulo</h3>
<p><em>Proyecto_1_fecha</em></p>
<p>Proyecto_1_resumen</p>
<p><a href="{{Proyecto_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">Proyecto_2_titulo</h3>
<p><em>Proyecto_2_fecha</em></p>
<p>Proyecto_2_resumen</p>
<p><a href="{{Proyecto_2_url}}" target="_blank">Ver m√°s</a></p>
<hr>

<h2 style="color: #216c2c;">5. Pol√≠ticas P√∫blicas</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">Politica_1_titulo</h3>
<p><em>Politica_1_fecha</em></p>
<p>Politica_1_resumen</p>
<p><a href="{{Politica_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">Politica_2_titulo</h3>
<p><em>Politica_2_fecha</em></p>
<p>Politica_2_resumen</p>
<p><a href="{{Politica_2_url}}" target="_blank">Ver m√°s</a></p>
<hr>

<h2 style="color: #216c2c;">6. Mercado</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">mercado_1_titulo</h3>
<p><em>mercado_1_fecha</em></p>
<p>mercado_1_resumen</p>
<p><a href="{{mercado_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">mercado_2_titulo</h3>
<p><em>mercado_2_fecha</em></p>
<p>mercado_2_resumen</p>
<p><a href="{{mercado_2_url}}" target="_blank">Ver m√°s</a></p>
<hr>


<h2 style="color: #216c2c;">7. Eventos</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>

<h3 style="color: #ffffff; background-color: #216c2c;">Evento_1_titulo</h3>
<p><em>Evento_1_fecha</em></p>
<p>Evento_1_resumen</p>
<p><a href="{{Evento_1_url}}" target="_blank">Ver m√°s</a></p>

<h3 style="color: #ffffff; background-color: #216c2c;">Evento_2_titulo</h3>
<p><em>Evento_2_fecha</em></p>
<p>Evento_2_resumen</p>
<p><a href="{{Evento_2_url}}" target="_blank">Ver m√°s</a></p>
<hr>

<h2 style="color: #216c2c;">Contacto y Cr√©ditos</h2>
<div style="height: 3px; width: 100%; background-color: #216c2c; margin-bottom: 20px;"></div>
<p>Fundaci√≥n para la Innovaci√≥n Agraria ‚Äì FIA</p>
<p>Bolet√≠n N¬∞{{numero_boletin}} ‚Äì {{mes}} {{a√±o}}</p>
        </textarea>

        <br>
        <div class="botones">
            <button type="submit" class="btn-guardar">Guardar borrador (BD + PDF)</button>
            <button type="button" class="btn-pdf" onclick="descargarPDFLocal()">Descargar PDF (Solo local)</button>
        </div>
    </form>

    <script>
        function descargarPDFLocal() {
            const contenido = tinymce.get('basic-example').getContent();
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = contenido;
            document.body.appendChild(tempDiv);

            html2pdf().from(tempDiv).set({
                margin: 1,
                filename: 'boletin.pdf',
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            }).save().then(() => {
                document.body.removeChild(tempDiv);
            });
        }
    </script>

    {% include 'base/componentes/Footer.html' %}
</body>
</html>
